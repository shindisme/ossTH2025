name: Deploy to Somee via FTP

on:
  push:
    branches:
      - main  # Hoặc nhánh bạn muốn deploy từ đó

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    # 1. Checkout mã nguồn từ repository
    - name: Checkout code
      uses: actions/checkout@v2

    # 2. Build ứng dụng (nếu cần thiết, ví dụ với .NET)
    - name: Build Application
      run: |
        dotnet publish -c Release -o ./build

    # 3. Upload file qua FTP bằng curl
    - name: Upload to FTP Server via curl
      run: |
        # Thiết lập thông tin đăng nhập FTP
        FTP_SERVER="${{ secrets.FTP_HOST}}"
        FTP_USERNAME="${{ secrets.FTP_USERNAME }}"
        FTP_PASSWORD="${{ secrets.FTP_PASSWORD }}"
        LOCAL_DIR="./build"  # Thư mục chứa các file bạn muốn upload
        REMOTE_DIR="/wwwroot"  # Thư mục đích trên server FTP
        
        # Upload tất cả file trong thư mục build lên FTP
        for file in $(find $LOCAL_DIR -type f); do
          curl -T $file ftp://$FTP_SERVER$REMOTE_DIR/ --user $FTP_USERNAME:$FTP_PASSWORD
        done
